import clsx from "clsx";
import { useState } from "react";
import { useNuiEvent } from "../../../hooks/useNuiEvent";
import { useSettings } from "../../../contexts/SettingsContext";
const gearIcon = () => (
  <svg
    width="8"
    height="8"
    viewBox="0 0 8 8"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M7.16884 3.97745C7.17028 3.9258 7.17028 3.87414 7.16884 3.82249L7.70403 3.15387C7.73209 3.11877 7.75151 3.07756 7.76073 3.03357C7.76995 2.98959 7.76871 2.94405 7.75711 2.90063C7.66922 2.57089 7.53799 2.25427 7.36685 1.95904C7.34442 1.92041 7.31328 1.88756 7.27592 1.86308C7.23856 1.83861 7.196 1.8232 7.15163 1.81807L6.30079 1.72337C6.2654 1.68607 6.22953 1.6502 6.19318 1.61576L6.09274 0.762771C6.08757 0.718369 6.07211 0.675787 6.04757 0.638421C6.02303 0.601055 5.99011 0.569938 5.95141 0.547551C5.6562 0.37654 5.33956 0.245542 5.00982 0.158002C4.9664 0.146401 4.92087 0.145162 4.87688 0.154383C4.83289 0.163604 4.79169 0.183028 4.75658 0.211089L4.08975 0.743402C4.0381 0.743402 3.98645 0.743402 3.9348 0.743402L3.26618 0.209296C3.23107 0.181234 3.18987 0.16181 3.14588 0.152589C3.10189 0.143368 3.05635 0.144608 3.01293 0.156208C2.6832 0.2441 2.36657 0.375332 2.07134 0.546475C2.03272 0.568903 1.99986 0.600038 1.97539 0.637401C1.95091 0.674765 1.9355 0.717325 1.93037 0.761695L1.83568 1.61397C1.79837 1.6496 1.7625 1.68547 1.72807 1.72158L0.875076 1.8195C0.830673 1.82467 0.788091 1.84014 0.750725 1.86468C0.713359 1.88921 0.682242 1.92214 0.659856 1.96083C0.48888 2.2561 0.35777 2.57272 0.269948 2.90242C0.258396 2.94587 0.257215 2.99142 0.266498 3.03541C0.275782 3.0794 0.295271 3.12059 0.323394 3.15567L0.855706 3.82249C0.855706 3.87414 0.855706 3.9258 0.855706 3.97745L0.321601 4.64607C0.293539 4.68117 0.274115 4.72238 0.264894 4.76637C0.255673 4.81035 0.256912 4.85589 0.268513 4.89931C0.356404 5.22905 0.487637 5.54567 0.658779 5.8409C0.681208 5.87953 0.712343 5.91238 0.749706 5.93686C0.78707 5.96133 0.82963 5.97674 0.874 5.98187L1.72484 6.07657C1.76047 6.11387 1.79634 6.14974 1.83245 6.18418L1.93181 7.03717C1.93698 7.08157 1.95244 7.12415 1.97698 7.16152C2.00152 7.19889 2.03444 7.23 2.07314 7.25239C2.36841 7.42337 2.68502 7.55448 3.01473 7.6423C3.05818 7.65385 3.10373 7.65503 3.14772 7.64575C3.1917 7.63646 3.2329 7.61697 3.26797 7.58885L3.9348 7.05654C3.98645 7.05797 4.0381 7.05797 4.08975 7.05654L4.75837 7.59172C4.79348 7.61978 4.83468 7.63921 4.87867 7.64843C4.92266 7.65765 4.9682 7.65641 5.01162 7.64481C5.3414 7.55707 5.65805 7.42583 5.95321 7.25454C5.99183 7.23211 6.02469 7.20098 6.04916 7.16361C6.07364 7.12625 6.08905 7.08369 6.09418 7.03932L6.18887 6.18848C6.22618 6.15309 6.26205 6.11722 6.29648 6.08087L7.14947 5.98044C7.19388 5.97527 7.23646 5.9598 7.27382 5.93527C7.31119 5.91073 7.34231 5.8778 7.36469 5.83911C7.53567 5.54384 7.66678 5.22722 7.7546 4.89752C7.76615 4.85407 7.76733 4.80852 7.75805 4.76453C7.74877 4.72054 7.72928 4.67935 7.70116 4.64427L7.16884 3.97745ZM4.01227 5.33477C3.7285 5.33477 3.45109 5.25062 3.21514 5.09297C2.97919 4.93531 2.79529 4.71122 2.68669 4.44905C2.57809 4.18687 2.54968 3.89838 2.60504 3.62005C2.6604 3.34173 2.79705 3.08607 2.99772 2.88541C3.19838 2.68475 3.45403 2.5481 3.73236 2.49274C4.01068 2.43737 4.29917 2.46579 4.56135 2.57438C4.82353 2.68298 5.04761 2.86688 5.20527 3.10284C5.36293 3.33879 5.44708 3.61619 5.44708 3.89997C5.44708 4.2805 5.29591 4.64545 5.02683 4.91453C4.75776 5.18361 4.39281 5.33477 4.01227 5.33477Z"
      fill="#0C4A3D"
    />
  </svg>
);

const SpeedoMeter7 = ({ fuel, gear, speed }) => {
  const { settings } = useSettings();

  const [seatBelts, setSeatBelts] = useState({
    seat_1: false,
    seat_2: false,
    seat_3: false,
    seat_4: false,
  });

  useNuiEvent("setSeatBelts", setSeatBelts);

  const activeBarsCount = Math.round((speed / 100) * 24);

  const generateIndicatorBars = (activeCount) => {
    let bars = [];
    for (let i = 0; i < 24; i++) {
      bars.push(
        <div
          key={i}
          className={`w-[4.87px] h-[29.21px] rounded-sm shadow-inner ${
            i < activeCount ? "bg-teal-500" : "bg-neutral-700"
          }`}
        />
      );
    }
    return bars;
  };

  return (
    <div
      className=" bg-black bg-opacity-30 gap-x-2 py-2 px-3 flex items-center justify-center"
      style={{
        scale: settings.speedometers.transform ? settings.speedometers.transform.toString() + "%" : '90%',
      }}
    >
      <div className="w-[250.05px]">
        <div className="flex items-center gap-x-2 relative">
          <div className="flex items-center justify-center gap-x-1">
            <div className="w-[23.27px] h-[42.05px] flex flex-col gap-y-1 items-center justify-center bg-teal-500 rounded-sm shadow-inner">
              <div
                className={clsx(
                  "flex  items-center justify-center text-center w-full text-emerald-900 text-sm/tight font-semibold font-['Orbitron']",
                  gear === 1 && "pr-0.5"
                )}
              >
                {gear}
              </div>
              {gearIcon()}
            </div>
            <div className="w-[23.27px] h-[42.05px] flex flex-col item-end justify-end bg-neutral-700 rounded-sm shadow-inner">
              <div
                style={{ height: fuel + "%" }}
                className="w-full rounded-sm bg-gradient-to-t flex items-center justify-center from-yellow-400 to-yellow-600"
              >
                <svg
                  width="9"
                  height="7"
                  viewBox="0 0 9 7"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M8.06004 1.80562L7.4118 1.15806C7.36148 1.10774 7.29324 1.07947 7.22209 1.07947C7.15093 1.07947 7.08269 1.10774 7.03237 1.15806C6.98206 1.20837 6.95379 1.27661 6.95379 1.34777C6.95379 1.41892 6.98206 1.48717 7.03237 1.53748L7.67994 2.18572C7.72997 2.2358 7.75816 2.30364 7.75837 2.37443V5.10179C7.75837 5.17291 7.73012 5.24111 7.67984 5.2914C7.62955 5.34168 7.56135 5.36993 7.49023 5.36993C7.41911 5.36993 7.35091 5.34168 7.30062 5.2914C7.25034 5.24111 7.22209 5.17291 7.22209 5.10179V3.76107C7.22209 3.54772 7.13733 3.34311 6.98647 3.19225C6.83561 3.04139 6.631 2.95663 6.41765 2.95663H5.88136V1.34777C5.88136 1.13442 5.79661 0.929808 5.64575 0.778948C5.49489 0.628088 5.29028 0.543335 5.07693 0.543335H2.39549C2.18214 0.543335 1.97753 0.628088 1.82667 0.778948C1.67581 0.929808 1.59105 1.13442 1.59105 1.34777V6.44251H1.05477C0.983649 6.44251 0.915446 6.47076 0.865159 6.52105C0.814872 6.57134 0.786621 6.63954 0.786621 6.71066C0.786621 6.78177 0.814872 6.84998 0.865159 6.90026C0.915446 6.95055 0.983649 6.9788 1.05477 6.9788H6.41765C6.48877 6.9788 6.55697 6.95055 6.60726 6.90026C6.65755 6.84998 6.6858 6.78177 6.6858 6.71066C6.6858 6.63954 6.65755 6.57134 6.60726 6.52105C6.55697 6.47076 6.48877 6.44251 6.41765 6.44251H5.88136V3.49292H6.41765C6.48877 3.49292 6.55697 3.52117 6.60726 3.57146C6.65755 3.62175 6.6858 3.68995 6.6858 3.76107V5.10179C6.6858 5.31514 6.77055 5.51975 6.92141 5.67061C7.07227 5.82147 7.27688 5.90622 7.49023 5.90622C7.70358 5.90622 7.90819 5.82147 8.05905 5.67061C8.20991 5.51975 8.29466 5.31514 8.29466 5.10179V2.37443C8.29507 2.26882 8.27454 2.16418 8.23427 2.06655C8.194 1.96892 8.13478 1.88024 8.06004 1.80562ZM4.52154 3.86162L3.98525 5.20234C3.95858 5.26839 3.90677 5.32114 3.8412 5.34899C3.77564 5.37684 3.7017 5.3775 3.63565 5.35083C3.56961 5.32416 3.51686 5.27235 3.48901 5.20678C3.46116 5.14122 3.4605 5.06728 3.48717 5.00124L3.87631 4.02921H3.19992C3.15597 4.02929 3.11268 4.01856 3.07385 3.99797C3.03503 3.97739 3.00185 3.94757 2.97725 3.91116C2.95265 3.87474 2.93738 3.83283 2.93279 3.78913C2.92819 3.74542 2.9344 3.70125 2.95088 3.66051L3.48717 2.31979C3.50038 2.28709 3.51989 2.2573 3.54461 2.23214C3.56932 2.20698 3.59875 2.18693 3.63121 2.17315C3.66368 2.15936 3.69854 2.1521 3.73381 2.15178C3.76907 2.15147 3.80406 2.1581 3.83676 2.17131C3.86947 2.18451 3.89925 2.20403 3.92441 2.22874C3.94957 2.25346 3.96962 2.28289 3.98341 2.31535C3.9972 2.34781 4.00446 2.38267 4.00477 2.41794C4.00509 2.45321 3.99845 2.4882 3.98525 2.5209L3.5961 3.49292H4.2725C4.31645 3.49285 4.35974 3.50357 4.39857 3.52416C4.43739 3.54475 4.47057 3.57456 4.49517 3.61098C4.51976 3.6474 4.53503 3.6893 4.53963 3.73301C4.54423 3.77671 4.53802 3.82088 4.52154 3.86162Z"
                    fill="#362A0A"
                  />
                </svg>
              </div>
            </div>
            <div className="relative flex items-center justify-center ml-4">
              <svg
                className="absolute"
                width="30"
                height="42"
                viewBox="0 0 30 42"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <rect
                  width="30"
                  height="42"
                  rx="1.21703"
                  fill={
                    Object.values(seatBelts).some((p) => p === true)
                      ? "#FF4343"
                      : "#3F3F3F"
                  }
                />
              </svg>
              <svg
                className="absolute"
                width="14"
                height="18"
                viewBox="0 0 14 18"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12.2258 10.5249C12.3658 10.0228 12.0945 9.49228 11.6305 9.35018C11.543 9.32176 11.4642 9.29334 11.3767 9.27439C11.3679 8.43127 11.2104 7.61656 10.9215 6.87764L6.16843 10.5533C7.84032 10.4491 9.52097 10.648 11.1403 11.1691C11.6043 11.3112 12.0945 11.027 12.2258 10.5249ZM8.55924 17.9762C8.62331 17.9919 8.68826 17.9993 8.75155 17.9993C9.15245 17.9993 9.51318 17.7005 9.60465 17.2592L10.48 13.0369C10.5758 12.5743 10.3415 12.1072 9.93115 11.9415C8.04025 11.1811 5.95966 11.1811 4.06876 11.9415C3.6584 12.1071 3.42425 12.5743 3.51992 13.0369L4.39526 17.2592C4.50126 17.7707 4.97141 18.0927 5.44068 17.9761C5.91257 17.8614 6.20913 17.3553 6.10313 16.8447L5.4047 13.4735C6.45782 13.1886 7.54175 13.1886 8.59486 13.4735L7.89643 16.8447C7.79069 17.3554 8.08734 17.8615 8.55924 17.9762ZM0.163621 12.8648C0.329935 13.1206 0.60129 13.2627 0.872644 13.2627C1.04771 13.2627 1.23153 13.2058 1.38034 13.0827L13.6351 3.60934C14.029 3.30619 14.1165 2.71885 13.8364 2.29255C13.5563 1.86625 13.0136 1.77151 12.6197 2.07466L9.31089 4.63246C9.25032 4.58216 9.18554 4.54284 9.12304 4.49747C9.43597 4.02967 9.62601 3.46032 9.62601 2.842C9.62601 1.2789 8.4443 0 7 0C5.55569 0 4.37399 1.2789 4.37399 2.842C4.37399 3.46326 4.56613 4.03479 4.88177 4.50381C3.70611 5.3386 2.85519 6.83132 2.66708 8.60179C2.64082 8.81967 2.62332 9.04703 2.62332 9.27439C2.53578 9.29334 2.457 9.32176 2.36947 9.35018C1.92305 9.48281 1.65169 9.98489 1.76549 10.468L0.364949 11.548C-0.0289525 11.8511 -0.116486 12.4385 0.163621 12.8648Z"
                  fill="#040F0A"
                />
              </svg>
            </div>
          </div>
          <div className="w-[200px] flex items-center justify-end">
            <span className="text-neutral-500 text-5xl font-semibold font-['Orbitron']">
              {speed !== 0 && speed < 100 ? "0" : ""}
            </span>
            <span className=" text-white text-5xl/snug font-semibold font-['Orbitron']">
              {speed}
            </span>
          </div>
        </div>
        <div className="flex items-center justify-between gap-x-1">
          {generateIndicatorBars(activeBarsCount)}
        </div>
      </div>
    </div>
  );
};

export default SpeedoMeter7;
